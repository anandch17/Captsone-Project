<div class="p-6 md:p-8 max-w-7xl mx-auto space-y-6 font-body animate-fade-in-up">
  <!-- Header -->
  <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-4 border-b border-slate-200 pb-5">
    <div class="flex items-center gap-4">
      <div
        class="w-12 h-12 bg-white rounded-xl shadow-sm border border-slate-200 flex items-center justify-center text-sky-500">
        <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round"
            d="M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z" />
        </svg>
      </div>
      <div>
        <h1 class="text-2xl font-display font-bold text-slate-900 tracking-tight">User Management</h1>
        <p class="text-sm font-medium text-slate-500">View and manage system access for all roles.</p>
      </div>
    </div>

    <div class="flex items-center gap-3">
      <div class="relative">
        <select (change)="filterRole($event)"
          class="appearance-none bg-white border border-slate-200 text-slate-700 font-semibold text-sm rounded-lg pl-4 pr-10 py-2.5 focus:outline-none focus:ring-2 focus:ring-sky-500/20 focus:border-sky-500 shadow-sm cursor-pointer transition-all">
          <option value="">All Roles</option>
          <option value="Customer">Customer</option>
          <option value="Agent">Agent</option>
          <option value="ClaimOfficer">Claim Officer</option>
        </select>
        <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-3 text-slate-400">
          <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
          </svg>
        </div>
      </div>
      <a routerLink="/admin/create-user"
        class="inline-flex items-center gap-1.5 bg-sky-600 font-semibold text-white text-sm px-4 py-2.5 rounded-lg shadow-md shadow-sky-600/20 hover:bg-sky-700 transition-colors transform active:scale-95">
        <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M12 4.5v15m7.5-7.5h-15" />
        </svg>
        Add User
      </a>
    </div>
  </div>

  <div class="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden relative">
    @if (loading()) {
    <div class="flex justify-center items-center py-20">
      <div class="animate-bounce p-4 rounded-full bg-sky-100 shadow-[0_0_20px_rgba(14,165,233,0.3)]">
        <div class="w-10 h-10 border-4 border-sky-500 border-t-transparent rounded-full animate-spin"></div>
      </div>
    </div>
    } @else {
    <div class="overflow-x-auto">
      <table class="w-full whitespace-nowrap text-left text-sm text-slate-600">
        <thead
          class="bg-slate-50/80 border-b border-slate-200 text-slate-500 uppercase tracking-wider font-bold text-[11px]">
          <tr>
            <th scope="col" class="px-6 py-4">User Details</th>
            <th scope="col" class="px-6 py-4">Role</th>
            <th scope="col" class="px-6 py-4 text-center">Status</th>
            <th scope="col" class="px-6 py-4 text-right">Actions</th>
          </tr>
        </thead>
        <tbody class="divide-y divide-slate-100 text-[14px]">
          @for (u of filteredUsers(); track u.id) {
          <tr class="hover:bg-sky-50/30 transition-colors group">
            <td class="px-6 py-4">
              <div class="flex flex-col">
                <span class="font-bold text-slate-800 text-[15px]">{{ u.name }}</span>
                <span class="text-[13px] font-medium text-slate-500">{{ u.email }}</span>
              </div>
            </td>
            <td class="px-6 py-4">
              <span class="inline-flex items-center rounded-md px-2.5 py-1 text-xs font-bold border shadow-sm"
                [class.bg-purple-50]="u.role === 'Admin'" [class.text-purple-700]="u.role === 'Admin'"
                [class.border-purple-200]="u.role === 'Admin'" [class.bg-sky-50]="u.role === 'Customer'"
                [class.text-sky-700]="u.role === 'Customer'" [class.border-sky-200]="u.role === 'Customer'"
                [class.bg-amber-50]="u.role === 'Agent'" [class.text-amber-700]="u.role === 'Agent'"
                [class.border-amber-200]="u.role === 'Agent'" [class.bg-emerald-50]="u.role === 'ClaimOfficer'"
                [class.text-emerald-700]="u.role === 'ClaimOfficer'"
                [class.border-emerald-200]="u.role === 'ClaimOfficer'">
                {{ u.role === 'ClaimOfficer' ? 'Claim Officer' : u.role }}
              </span>
            </td>
            <td class="px-6 py-4 text-center">
              @if (u.isActive) {
              <span
                class="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-bold text-emerald-700 bg-emerald-50 border border-emerald-200 shadow-sm mx-auto">
                <span class="w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse"></span> Active
              </span>
              } @else {
              <span
                class="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-bold text-slate-500 bg-slate-100 border border-slate-200 shadow-sm mx-auto">
                <span class="w-1.5 h-1.5 rounded-full bg-slate-400"></span> Inactive
              </span>
              }
            </td>
            <td class="px-6 py-4 text-right">
              @if (u.role !== 'Admin') {
              <button type="button" (click)="u.isActive ? deactivate(u.id) : activate(u.id)"
                class="text-xs font-bold uppercase tracking-wider px-3 py-2 rounded-lg border transition-colors inline-flex items-center gap-1 shadow-sm focus:ring-4"
                [class.text-rose-600]="u.isActive" [class.bg-white]="u.isActive" [class.border-rose-200]="u.isActive"
                [class.hover:bg-rose-50]="u.isActive" [class.focus:ring-rose-500/20]="u.isActive"
                [class.text-emerald-600]="!u.isActive" [class.bg-white]="!u.isActive"
                [class.border-emerald-200]="!u.isActive" [class.hover:bg-emerald-50]="!u.isActive"
                [class.focus:ring-emerald-500/20]="!u.isActive">
                @if (u.isActive) {
                <svg class="w-3.5 h-3.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5"
                    d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636" />
                </svg>
                Deactivate
                } @else {
                <svg class="w-3.5 h-3.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M5 13l4 4L19 7" />
                </svg>
                Activate
                }
              </button>
              }
            </td>
          </tr>
          }
        </tbody>
      </table>
    </div>
    @if (filteredUsers().length === 0) {
    <div class="py-12 flex flex-col items-center justify-center text-center">
      <div class="w-16 h-16 bg-slate-50 rounded-full flex items-center justify-center mb-3">
        <svg class="w-8 h-8 text-slate-300" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
          <path stroke-linecap="round" stroke-linejoin="round"
            d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" />
        </svg>
      </div>
      <p class="text-slate-500 font-medium">No users found matching the selected filter.</p>
    </div>
    }
    }
  </div>
</div>